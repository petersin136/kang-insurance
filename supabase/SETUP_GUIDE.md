# Supabase ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ì´ ê°€ì´ë“œëŠ” ë³´í—˜ì„¤ê³„ì‚¬ í™ˆí˜ì´ì§€ì— í•„ìš”í•œ Supabase ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ì ìš©í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ¯ Supabase í”„ë¡œì íŠ¸ ì •ë³´

- **Project URL**: https://bfvrunxorsxgmeykvfru.supabase.co
- **Project ID**: bfvrunxorsxgmeykvfru
- **Region**: ì„¤ì •ëœ ë¦¬ì „ ì‚¬ìš©

## ğŸ“ ìŠ¤í‚¤ë§ˆ ì ìš© ë‹¨ê³„

### ë°©ë²• 1: Supabase Dashboard (ì¶”ì²œ) ğŸ‘

ê°€ì¥ ê°„ë‹¨í•˜ê³  ì•ˆì „í•œ ë°©ë²•ì…ë‹ˆë‹¤.

#### 1ë‹¨ê³„: Supabase Dashboard ì ‘ì†

1. ë¸Œë¼ìš°ì €ì—ì„œ https://app.supabase.com ì—´ê¸°
2. ë¡œê·¸ì¸ (MCP í† í° ì‚¬ìš©: `sbp_aafe32822590653c79b1b1aa869a2f7d000fa8db`)
3. í”„ë¡œì íŠ¸ ëª©ë¡ì—ì„œ **bfvrunxorsxgmeykvfru** ì„ íƒ

#### 2ë‹¨ê³„: SQL Editor ì—´ê¸°

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **SQL Editor** í´ë¦­
2. **New Query** ë²„íŠ¼ í´ë¦­

#### 3ë‹¨ê³„: ì´ˆê¸° ìŠ¤í‚¤ë§ˆ ì ìš©

1. `supabase/migrations/20241030_initial_schema.sql` íŒŒì¼ ì—´ê¸°
2. ì „ì²´ ë‚´ìš© ë³µì‚¬ (Cmd/Ctrl + A â†’ Cmd/Ctrl + C)
3. SQL Editorì— ë¶™ì—¬ë„£ê¸° (Cmd/Ctrl + V)
4. **RUN** ë²„íŠ¼ í´ë¦­ ë˜ëŠ” (Cmd/Ctrl + Enter)
5. ì„±ê³µ ë©”ì‹œì§€ í™•ì¸:
   ```
   ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!
   - 9ê°œ í…Œì´ë¸” ìƒì„± ì™„ë£Œ
   - Storage ë²„í‚· ë° ì •ì±… ì„¤ì • ì™„ë£Œ
   - RLS ì •ì±… ì ìš© ì™„ë£Œ
   - ì¸ë±ìŠ¤ ë° íŠ¸ë¦¬ê±° ìƒì„± ì™„ë£Œ
   ```

#### 4ë‹¨ê³„: ìƒ˜í”Œ ë°ì´í„° ì‚½ì… (ì„ íƒì‚¬í•­)

1. **New Query** ë²„íŠ¼ìœ¼ë¡œ ìƒˆ ì¿¼ë¦¬ ì°½ ì—´ê¸°
2. `supabase/migrations/20241030_seed_data.sql` íŒŒì¼ ì—´ê¸°
3. ì „ì²´ ë‚´ìš© ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°
4. **RUN** ë²„íŠ¼ í´ë¦­
5. ì„±ê³µ ë©”ì‹œì§€ í™•ì¸:
   ```
   ìƒ˜í”Œ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚½ì…ë˜ì—ˆìŠµë‹ˆë‹¤!
   - ë³´í—˜ ìƒí’ˆ: 8ê°œ
   - ê³ ê° í›„ê¸°: 6ê°œ
   - ì„±ê³µ ì‚¬ë¡€: 3ê°œ
   - ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸: 3ê°œ
   ```

#### 5ë‹¨ê³„: ë°ì´í„° í™•ì¸

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Table Editor** í´ë¦­
2. ìƒì„±ëœ í…Œì´ë¸” ëª©ë¡ í™•ì¸:
   - `app_public.profiles`
   - `app_public.insurance_products`
   - `app_public.testimonials`
   - `app_public.cases`
   - `app_public.consultations`
   - `app_public.blog_posts`
   - `app_public.pages`
   - `app_public.sections`
   - `app_public.site_settings`

3. ê° í…Œì´ë¸”ì„ í´ë¦­í•˜ì—¬ ë°ì´í„° í™•ì¸

#### 6ë‹¨ê³„: Storage ë²„í‚· í™•ì¸

1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Storage** í´ë¦­
2. `public-media` ë²„í‚·ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸
3. ë²„í‚·ì„ í´ë¦­í•˜ì—¬ ì •ì±… í™•ì¸

---

### ë°©ë²• 2: Supabase CLI ì‚¬ìš©

ê°œë°œììš© ë°©ë²•ì…ë‹ˆë‹¤.

#### 1ë‹¨ê³„: Supabase CLI ì„¤ì¹˜

```bash
npm install -g supabase
```

#### 2ë‹¨ê³„: í”„ë¡œì íŠ¸ ë§í¬

```bash
cd /Users/seung-yongmaegbug/kang-insurance
supabase link --project-ref bfvrunxorsxgmeykvfru
```

í”„ë¡¬í”„íŠ¸ê°€ ë‚˜íƒ€ë‚˜ë©´ ì•¡ì„¸ìŠ¤ í† í° ì…ë ¥: `sbp_aafe32822590653c79b1b1aa869a2f7d000fa8db`

#### 3ë‹¨ê³„: ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©

```bash
# ëª¨ë“  ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì ìš©
supabase db push

# ë˜ëŠ” íŠ¹ì • íŒŒì¼ë§Œ ì ìš©
supabase db execute --file supabase/migrations/20241030_initial_schema.sql
supabase db execute --file supabase/migrations/20241030_seed_data.sql
```

#### 4ë‹¨ê³„: ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒíƒœ í™•ì¸

```bash
supabase migration list
```

---

## âœ… ìŠ¤í‚¤ë§ˆ ì ìš© í™•ì¸

### 1. í…Œì´ë¸” ìƒì„± í™•ì¸

ë‹¤ìŒ SQLì„ ì‹¤í–‰í•˜ì—¬ ëª¨ë“  í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸:

```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'app_public'
ORDER BY table_name;
```

ì˜ˆìƒ ê²°ê³¼ (9ê°œ í…Œì´ë¸”):
- blog_posts
- cases
- consultations
- insurance_products
- pages
- profiles
- sections
- site_settings
- testimonials

### 2. Storage ë²„í‚· í™•ì¸

```sql
SELECT * FROM storage.buckets;
```

ì˜ˆìƒ ê²°ê³¼:
- id: `public-media`
- name: `public-media`
- public: `true`

### 3. RLS ì •ì±… í™•ì¸

```sql
SELECT schemaname, tablename, policyname 
FROM pg_policies 
WHERE schemaname = 'app_public'
ORDER BY tablename, policyname;
```

ê° í…Œì´ë¸”ì— 2-3ê°œì˜ ì •ì±…ì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

### 4. ìƒ˜í”Œ ë°ì´í„° í™•ì¸

```sql
-- ë³´í—˜ ìƒí’ˆ ìˆ˜
SELECT COUNT(*) FROM app_public.insurance_products;
-- ê²°ê³¼: 8

-- ê³ ê° í›„ê¸° ìˆ˜
SELECT COUNT(*) FROM app_public.testimonials;
-- ê²°ê³¼: 6

-- ì„±ê³µ ì‚¬ë¡€ ìˆ˜
SELECT COUNT(*) FROM app_public.cases;
-- ê²°ê³¼: 3

-- ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ìˆ˜
SELECT COUNT(*) FROM app_public.blog_posts;
-- ê²°ê³¼: 3
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: "relation already exists" ì˜¤ë¥˜

**ì›ì¸**: í…Œì´ë¸”ì´ ì´ë¯¸ ì¡´ì¬í•¨

**í•´ê²°ì±…**: 
```sql
-- ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ (ì£¼ì˜: ë°ì´í„°ë„ ì‚­ì œë¨)
DROP SCHEMA IF EXISTS app_public CASCADE;

-- ë‹¤ì‹œ ìŠ¤í‚¤ë§ˆ ì‹¤í–‰
-- 20241030_initial_schema.sql ë‹¤ì‹œ ì‹¤í–‰
```

### ë¬¸ì œ 2: "permission denied" ì˜¤ë¥˜

**ì›ì¸**: RLS ì •ì±…ìœ¼ë¡œ ì¸í•œ ê¶Œí•œ ë¶€ì¡±

**í•´ê²°ì±…**:
1. Supabase Dashboardì—ì„œ SQL Editor ì‚¬ìš© (ì„œë¹„ìŠ¤ ë¡¤ ê¶Œí•œ)
2. ë˜ëŠ” `SUPABASE_SERVICE_ROLE_KEY` ì‚¬ìš©í•˜ì—¬ API í˜¸ì¶œ

### ë¬¸ì œ 3: Storage ì •ì±…ì´ ì ìš©ë˜ì§€ ì•ŠìŒ

**ì›ì¸**: ë²„í‚·ì´ ë¨¼ì € ìƒì„±ë˜ì§€ ì•ŠìŒ

**í•´ê²°ì±…**:
```sql
-- ë²„í‚· ë¨¼ì € í™•ì¸
SELECT * FROM storage.buckets WHERE id = 'public-media';

-- ì—†ìœ¼ë©´ ìˆ˜ë™ ìƒì„±
INSERT INTO storage.buckets (id, name, public)
VALUES ('public-media', 'public-media', true)
ON CONFLICT DO NOTHING;

-- ì •ì±… ë‹¤ì‹œ ì ìš©
-- Storage ì •ì±… SQL ë‹¤ì‹œ ì‹¤í–‰
```

### ë¬¸ì œ 4: í”„ë¡œí•„ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ì—†ìŒ

**ì›ì¸**: auth.users í…Œì´ë¸”ì— ì‚¬ìš©ìê°€ ì—†ìŒ

**í•´ê²°ì±…**:
1. Supabase Dashboard â†’ Authentication ë©”ë‰´
2. í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„± (ê´€ë¦¬ì ê³„ì •)
3. SQLë¡œ role ì—…ë°ì´íŠ¸:
```sql
UPDATE app_public.profiles 
SET role = 'admin' 
WHERE email = 'your-email@example.com';
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

ìŠ¤í‚¤ë§ˆ ì ìš©ì´ ì™„ë£Œë˜ë©´:

1. âœ… ê°œë°œ ì„œë²„ ì¬ì‹œì‘: `npm run dev`
2. âœ… í™ˆí˜ì´ì§€ ì ‘ì†: http://localhost:3000
3. âœ… ìƒ˜í”Œ ë°ì´í„° í™•ì¸:
   - ë³´í—˜ ìƒí’ˆ ì„¹ì…˜
   - ê³ ê° í›„ê¸° ì„¹ì…˜
   - ë¸”ë¡œê·¸ í˜ì´ì§€
4. âœ… ê´€ë¦¬ì í˜ì´ì§€ ì ‘ì†: http://localhost:3000/admin/dashboard

---

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- [Supabase RLS ê°€ì´ë“œ](https://supabase.com/docs/guides/auth/row-level-security)
- [Supabase Storage ê°€ì´ë“œ](https://supabase.com/docs/guides/storage)
- [PostgreSQL ê³µì‹ ë¬¸ì„œ](https://www.postgresql.org/docs/)

---

## ğŸ’¡ íŒ

### ê°œë°œ ì¤‘ ë°ì´í„° ì´ˆê¸°í™”

ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ê³  ì‹¶ì„ ë•Œ:

```sql
-- ëª¨ë“  ë°ì´í„° ì‚­ì œ (í…Œì´ë¸” êµ¬ì¡°ëŠ” ìœ ì§€)
TRUNCATE TABLE app_public.insurance_products RESTART IDENTITY CASCADE;
TRUNCATE TABLE app_public.testimonials RESTART IDENTITY CASCADE;
TRUNCATE TABLE app_public.cases RESTART IDENTITY CASCADE;
TRUNCATE TABLE app_public.consultations RESTART IDENTITY CASCADE;
TRUNCATE TABLE app_public.blog_posts RESTART IDENTITY CASCADE;

-- ìƒ˜í”Œ ë°ì´í„° ë‹¤ì‹œ ì‚½ì…
-- 20241030_seed_data.sql ë‹¤ì‹œ ì‹¤í–‰
```

### TypeScript íƒ€ì… ìë™ ìƒì„±

ìŠ¤í‚¤ë§ˆ ë³€ê²½ í›„ TypeScript íƒ€ì… ì—…ë°ì´íŠ¸:

```bash
npx supabase gen types typescript --project-id bfvrunxorsxgmeykvfru > types/database.ts
```

---

ë¬¸ì œê°€ ë°œìƒí•˜ë©´ [Supabase Discord](https://discord.supabase.com)ë‚˜ í”„ë¡œì íŠ¸ ë‹´ë‹¹ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”!

